/**
* snakepong
* version: 0.1.0
* date: 28-09-2013
*
* Â©2013 Slemgrim
* slemgrim@gmail.com 
*
* License: GNU GENERAL PUBLIC LICENSE v2
*/
define("app/log",[],function(){return{error:function(e){console.log("WARNING: "+e)},warn:function(e){console.log("ERROR: "+e)},info:function(e){console.log(e)}}}),define("app/event",[],function(){return{add:function(t,n,r){t.addEventListener?t.addEventListener(n,r,!1):t.attachEvent?t.attachEvent("on"+n,r):t["on"+n]=r},remove:function(){console.log("remove")},preventDefault:function(e){e.preventDefault()}}}),define("app/dom",[],function(){return{el:function(e,t){return t?t.querySelector(e):document.querySelector(e)},els:function(e,t){return t?t.querySelectorAll(e):document.querySelectorAll(e)}}}),define("app/classlist",[],function(){return{add:function(e,t){e.classList.add(t)},remove:function(e,t){e.classList.remove(t)},toggle:function(e,t){e.classList.toggle(t)},contains:function(e,t){return e.classList.contains(t)}}}),define("app/core",["app/log","app/event","app/dom","app/classlist"],function(e,t,n,r){return{log:e,event:t,dom:n,classlist:r}}),define("gui/debug",["app/core"],function(e){return function(t,n){var r=function(){i()},i=function(){e.event.add(t,"click",s)},s=function(t){e.event.preventDefault(t),e.classlist.toggle(n,"show")};r()}}),define("gui/canvas-handler",["app/core"],function(e){return function(t){var n,r,i=[],s=200,o=null;this.registerListener=function(e){i.push(e)};var u=function(){a(),l()},a=function(){e.event.add(window,"resize",f)},f=function(){o!=null&&clearTimeout(o),o=window.setTimeout(function(){l()},s)},l=function(){c(),h(),p()},c=function(){n=t.offsetWidth,r=t.offsetHeight},h=function(){t.setAttribute("width",n),t.setAttribute("height",r)},p=function(){for(var e=0;e<i.length;e++)i[e].canvasChange(n,r)};u()}}),define("game/loop",[],function(){return function(e){var t={deltaTime:.01,maxFrameTime:.25,fpsCallback:!1,renderCallback:!1,updateCallback:!1,clock:!1},n="",r=0,i=0,s=0,o=0,u={RUNNING:0,PAUSED:1,STOPPED:2},a=function(){if(typeof e=="object")for(var r in t)e[r]||(e[r]=t[r]);else e=t;e.clock||(e.clock=c),n=u.STOPPED};this.setUpdateCallback=function(t){e.updateCallback=t},this.setRenderCallback=function(t){e.rendererCallback=newRenderCallback},this.start=function(e){n==u.STOPPED&&(s=l(),n=u.RUNNING,e&&e(),f())},this.pause=function(e){n==u.RUNNING&&(n=u.PAUSED,e&&e())},this.stop=function(e){n!=u.STOPPED&&(n=u.STOPPED,e&&e())},this.resume=function(e){n==u.PAUSED&&(n=u.RUNNING,e&&e(),f())},this.setFPSCallback=function(t){t&&(e.fpsCallback=t)},this.setDeltaTime=function(t){e.deltaTime=t};var f=function(){if(n==u.RUNNING){var t=l(),a=t-s;i=1/a*1e3,e.fpsCallback&&e.fpsCallback(i),a>e.maxFrameTime&&(a=e.maxFrameTime),s=t,o+=a;while(o>=e.deltaTime)e.updateCallback&&e.updateCallback(e.deltaTime),r+=e.deltaTime,o-=e.deltaTime;e.renderCallback&&e.renderCallback(),e.clock(f)}},l=function(){return date=new Date,date.getTime()},c=function(e){window.requestAnimationFrame?window.requestAnimationFrame(e):window.webkitRequestAnimationFrame?window.webkitRequestAnimationFrame(e):window.mozRequestAnimationFrame?window.mozRequestAnimationFrame(e):window.setTimeout(e,1e3/60)};a()}}),define("game/vector2",["app/core"],function(e){return function(e,t){this.x=e||0,this.y=t||0,this.reset=function(e,t){return this.x=e,this.y=t,this},this.copyTo=function(e){e.x=this.x,e.y=this.y},this.copyFrom=function(e){this.x=e.x,this.y=e.y}}}),define("game/world",["app/core","game/vector2"],function(e,t){return function(e,n){var r=new t(e,n),i=[],s;this.getSize=function(){return r};var o=function(){};this.update=function(e){},o()}}),define("game/render2D",["app/core"],function(e){return function(e){var t,n,r,i=function(){t=e.getContext("2d"),s()};this.initCanvas=function(){t=e.getContext("2d")},this.init=function(){i()},this.draw=function(i){n=i.world,r=i.camera;var u=r.getSize(),a=o(u.x,"x"),f=o(u.y,"y");s(),t.fillStyle="#ffffff",t.fillRect(e.width/2-a/2,e.height/2-f/2,a,f)};var s=function(){t.clearRect(0,0,e.width,e.height),t.fillStyle="#000000",t.fillRect(0,0,e.width,e.height)},o=function(t){var n=r.getSize(),i=e.width/n.x,s=e.height/n.y;return i<s?t*i:t*s};i()}}),define("game/camera",["app/core","game/vector2"],function(e,t){return function(e,n){var r=new t(16,10),i=new t(e,n);this.getSize=function(){return r},this.getPosition=function(){return i},this.setPosition=function(e,t){i.x=e,i.y=t};var s=function(){};s()}}),define("game/snakepong",["app/core","game/loop","game/world","game/render2D","game/camera"],function(e,t,n,r,i){return function(e){var s,o,u,a,f,l,c=function(){f=new r(e),l=new i(100,100),o=new n(640,480),s=new t({updateCallback:h,renderCallback:p}),s.start()},h=function(e){o.update(e)},p=function(){f.draw({camera:l,world:o})};this.canvasChange=function(e,t){f.initCanvas()},c()}}),require.config({baseUrl:"src"}),require(["app/core","gui/debug","gui/canvas-handler","game/snakepong"],function(e,t,n,r){var i=e.dom.el("#main-canvas"),s,o,u,a=function(){s=new r(i),o=new t(e.dom.el(".debug"),e.dom.el("#debug")),u=new n(i),u.registerListener(s)};a()}),define("main",function(){});