/**
* snakepong
* version: 0.1.0
* date: 05-10-2013
*
* Â©2013 Slemgrim
* slemgrim@gmail.com 
*
* License: GNU GENERAL PUBLIC LICENSE v2
*/
define("app/log",[],function(){return{error:function(e){console.log("WARNING: "+e)},warn:function(e){console.log("ERROR: "+e)},info:function(e){console.log(e)}}}),define("app/event",[],function(){return{add:function(t,n,r){t.addEventListener?t.addEventListener(n,r,!1):t.attachEvent?t.attachEvent("on"+n,r):t["on"+n]=r},remove:function(e,t){console.log("remove")},preventDefault:function(e){e.preventDefault()}}}),define("app/dom",[],function(){return{el:function(e,t){return t&&t.typeOf==="object"?t.querySelector(e):document.querySelector(e)},els:function(e,t){return t&&t.typeOf==="object"?t.querySelectorAll(e):document.querySelectorAll(e)}}}),define("app/classlist",[],function(){return{add:function(e,t){e.classList.add(t)},remove:function(e,t){e.classList.remove(t)},toggle:function(e,t){e.classList.toggle(t)},contains:function(e,t){return e.classList.contains(t)}}}),define("app/core",["app/log","app/event","app/dom","app/classlist"],function(e,t,n,r){return{log:e,event:t,dom:n,classlist:r}}),define("gui/canvas-handler",["app/core"],function(e){return function(t){var n,r,i=[],s=200,o=null;this.registerListener=function(e){i.push(e)},this.update=function(){f()};var u=function(){a(),f()},a=function(){e.event.add(window,"resize",f)},f=function(){o!=null&&clearTimeout(o),o=window.setTimeout(function(){l()},s)},l=function(){c(),h(),p()},c=function(){n=t.offsetWidth,r=t.offsetHeight},h=function(){t.setAttribute("width",n),t.setAttribute("height",r)},p=function(){for(var e=0;e<i.length;e++)i[e].canvasChange(n,r)};u()}}),define("game/loop",[],function(){return function(e){var t={deltaTime:.01,maxFrameTime:.25,fpsCallback:!1,renderCallback:!1,updateCallback:!1,clock:!1},n="",r=0,i=0,s=0,o=0,u={RUNNING:0,PAUSED:1,STOPPED:2},a=function(){if(typeof e=="object")for(var r in t)e[r]||(e[r]=t[r]);else e=t;e.clock||(e.clock=c),n=u.STOPPED};this.setUpdateCallback=function(t){e.updateCallback=t},this.setRenderCallback=function(t){e.rendererCallback=t},this.start=function(e){n===u.STOPPED&&(s=l(),n=u.RUNNING,e&&e(),f())},this.pause=function(e){n===u.RUNNING&&(n=u.PAUSED,e&&e())},this.stop=function(e){n!==u.STOPPED&&(n=u.STOPPED,e&&e())},this.resume=function(e){n===u.PAUSED&&(n=u.RUNNING,e&&e(),f())},this.setFPSCallback=function(t){t&&(e.fpsCallback=t)},this.setDeltaTime=function(t){e.deltaTime=t};var f=function(){if(n===u.RUNNING){var t=l(),a=t-s;i=1/a*1e3,e.fpsCallback&&e.fpsCallback(i),a>e.maxFrameTime&&(a=e.maxFrameTime),s=t,o+=a;while(o>=e.deltaTime)e.updateCallback&&e.updateCallback(e.deltaTime),r+=e.deltaTime,o-=e.deltaTime;e.renderCallback&&e.renderCallback(),e.clock(f)}},l=function(){var e=new Date;return e.getTime()},c=function(e){window.requestAnimationFrame?window.requestAnimationFrame(e):window.webkitRequestAnimationFrame?window.webkitRequestAnimationFrame(e):window.mozRequestAnimationFrame?window.mozRequestAnimationFrame(e):window.setTimeout(e,1e3/60)};a()}}),define("game/debug",["app/core","game/loop"],function(e,t){return function(e){var n=[],r,i,s=e.width;this.addFps=function(e){n=n.splice(s*-1,s),n.push(e)},this.reset=function(){n=[]};var o=function(){r=new t({renderCallback:u}),i=e.getContext("2d"),r.start()},u=function(){i.clearRect(0,0,e.width,e.height),i.fillStyle="#000000",i.fillRect(0,0,e.width,e.height),i.fillStyle="#00ff00";var t=1;n.map(function(e){i.fillRect(t,100-e,1,e),t++}),i.fillStyle="#ff0000",i.fillRect(0,40,e.width,1),i.fillStyle="#cccccc",i.fillRect(0,0,e.width,1),i.fillRect(0,25,e.width,1),i.fillRect(0,50,e.width,1),i.fillRect(0,75,e.width,1),i.fillRect(0,99,e.width,1)};o()}}),define("game/math/vector2",[],function(){return function(e,t){typeof e=="object"?(this.x=e.x||0,this.y=e.y||0):(this.x=e||0,this.y=t||0),this.reset=function(e,t){return this.x=e,this.y=t,this},this.clear=function(e,t){this.x=0,this.y=0},this.copyTo=function(e){return e.x=this.x,e.y=this.y,this},this.copyFrom=function(e){return this.x=e.x,this.y=e.y,this},this.add=function(e){return this.x+=e.x,this.y+=e.y,this},this.addX=function(e){return this.x+=e,this},this.addY=function(e){return this.y+=e,this},this.sub=function(e){return this.x-=e.x,this.y-=e.y,this},this.subX=function(e){return this.x-=e,this},this.subY=function(e){return this.y-=e,this},this.mul=function(e){return typeof e=="object"?(this.x*=e.x,this.y*=e.y):this.x*=e,this.y*=e,this},this.div=function(e){return typeof e=="object"?(this.x/=e.x,this.y/=e.y):this.x/=e,this.y/=e,this},this.mulScalar=function(e){return this.x*=e,this.y*=e,this},this.perp=function(){var e=this.x;return this.x=this.y,this.y=-e,this},this.reverse=function(){return this.x=-this.x,this.y=-this.y,this},this.nor=function(){var e=this.len();return e>0&&(this.x=this.x/e,this.y=this.y/e),this},this.scale=function(e,t){return this.x*=e,this.y*=t||e,this},this.project=function(e){var t=this.dot(e)/e.len2();return this.x=t*e.x,this.y=t*e.y,this},this.projectN=function(e){var t=this.dot(e);return this.x=t*e.x,this.y=t*e.y,this},this.reflect=function(e){var t=this.x,n=this.y;return this.project(e).scale(2),this.x-=t,this.y-=n,this},this.reflectN=function(e){var t=this.x,n=this.y;return this.projectN(e).scale(2),this.x-=t,this.y-=n,this},this.dot=function(e){return this.x*e.x+this.y*e.y},this.len2=function(){return this.dot(this)},this.len=function(){return Math.sqrt(this.len2())},this.distance=function(e){var t=this.sub(e).len();return this.add(e),t},this.equals=function(e){return this.x===e.x&&this.y===e.y},this.isZero=function(){return this.len()<1e-4}}}),define("game/collision/polygon",["app/core","game/math/vector2"],function(e,t){return function(e,n,r){this.TYPE="POLYGON",this.position=new t(e,n),this.points=r||[],this.edges=[],this.normals=[],this.set=function(e,t){this.position.x=e.x,this.position.y=e.y,t&&(this.points=t),this.calc()},this.calc=function(){var e=this.points,n=e.length;this.edges=[],this.normals=[];for(var r=0;r<n;r++){var i=e[r],s=r<n-1?e[r+1]:e[0],o=(new t).copyFrom(s).sub(i),u=(new t).copyFrom(o).perp().nor();this.edges.push(o),this.normals.push(u)}},this.calc()}}),define("game/collision/rectangle",["app/core","game/math/vector2","game/collision/polygon"],function(e,t,n){return function(e,r,i,s){this.TYPE="RECT",this.size=new t(i,s),this.position=new t(e,r),this.update=function(e,t){this.position=e,t&&(this.size=t)},this.set=function(e){this.position.x=e.x,this.position.y=e.y},this.toPolygon=function(){return new n(this.position.x,this.position.y,[new t(-this.size.x/2,-this.size.y/2),new t(this.size.x/2,-this.size.y/2),new t(-this.size.x/2,this.size.y/2),new t(this.size.x/2,this.size.y/2)])},this.getTopRight=function(){return new t(this.position.x+this.size.x/2,this.position.y+this.size.y/2)},this.getBottomLeft=function(){return new t(this.position.x-this.size.x/2,this.position.y-this.size.y/2)}}}),define("game/math/spring",["app/core","game/math/vector2"],function(e,t){return function(e,n,r,i,s){this.constant=r,this.damping=i,this.length=s,this.actor1=e,this.actor2=n,this.on=!0;var o=function(){return e.position.distance(n.position)};this.update=function(){var e=this.actor1,n=this.actor2;if(!this.on||!!e.statoc&&!!n.static)return this;var r=(new t(e.position)).sub(n.position),i=r.len();i===0?r.clear():r.div(i);var s=-1*(i-this.length)*this.constant,o=(new t(e.velocity)).sub(n.velocity),u=-1*this.damping*o.dot(r),a=s+u;return r.mul(a),n.static||n.addForce(r.reverse()),this},this.resting=function(){var e=this.actor1,t=this.actor2,n=this.length;return!this.on||e.static&&t.static||e.static&&(n===0?t.position.equals(e.position):t.position.distance(e.position)<=n)&&t.resting()||t.static&&(n===0?e.position.equals(t.position):e.position.distance(t.position)<=n)&&e.resting()}}}),define("game/item/ball",["app/core","game/math/vector2","game/collision/rectangle","game/math/spring"],function(e,t,n,r){return function(e,i,s){this.TYPE="BALL",this.radius=s,this.size=new t(s*2,s*2),this.position=new t(e,i),this.velocity=new t(0,0),this.speed=1,this.friction=0,this.affectedByGravity=!0,this.noCollision=!1,this.springs=[],this.collidable=!0,this.static=!1,this.childs=[],this.bounds=new n(e,i,s*2,s*2),this.update=function(e){var n=new t(this.velocity.x,this.velocity.y);n.mulScalar(this.speed*e);for(var r=0;r<this.springs.length;r++)this.springs[r].update();this.position.add(n),this.bounds.set(this.position),this.velocity.mulScalar(1-this.friction)},this.addForce=function(e){this.velocity.add(e)},this.addChild=function(e){this.childs.push(e);var t=new r(this,e,.99,.1,e.radius+this.radius-1);this.springs.push(t)},this.resting=function(){return this.static||this.velocity.isZero()}}}),define("game/item/player",["app/core","game/math/vector2","game/collision/rectangle"],function(e,t,n){return function(e,r,i,s){this.TYPE="PLAYER",this.size=new t(i,s),this.position=new t(e,r),this.velocity=new t(0,0),this.speed=2,this.friction=.002,this.affectedByGravity=!1,this.static=!1,this.ballTouches=0,this.initX=e,this.collidable=!0,this.static=!1,this.bounds=new n(e,r,i,s),this.update=function(e){var n=new t(this.velocity.x,this.velocity.y);n.mulScalar(this.speed*e),this.position.add(n),this.bounds.set(this.position),this.velocity.mul(1-this.friction),this.position.x=this.initX},this.addForce=function(e){this.velocity.add(e)},this.up=function(){this.velocity.y+=this.speed},this.down=function(){this.velocity.y-=this.speed},this.collision=function(e){e.TYPE==="BALL"&&this.ballTouches++}}}),define("game/item/wall",["app/core","game/math/vector2","game/collision/rectangle"],function(e,t,n){return function(e,r,i,s){this.TYPE="WALL",this.size=new t(i,s),this.position=new t(e,r),this.velocity=new t(0,0),this.speed=0,this.friction=0,this.affectedByGravity=!1,this.initPosition=new t(e,r),this.collidable=!0,this.static=!0,this.bounds=new n(e,r,i,s),this.update=function(e){var n=new t(this.velocity.x,this.velocity.y);n.mulScalar(this.speed*e),this.position.add(n),this.bounds.set(this.position),this.velocity.mulScalar(1-this.friction),this.position.y=this.initPosition.y,this.position.x=this.initPosition.x},this.addForce=function(e){this.velocity.add(e)}}}),define("game/collision/sat",["app/core","game/math/vector2"],function(e,t){return function(){var e=[],n=[],r=-1,i=0,s=1,o=function(){for(var r=0;r<10;r++)e.push(new t);for(r=0;r<5;r++)n.push([])},u=function(e,t,n){var r=Number.MAX_VALUE,i=-Number.MAX_VALUE,s=e.length;for(var o=0;o<s;o++){var u=e[o].dot(t);u<r&&(r=u),u>i&&(i=u)}n[0]=r,n[1]=i},a=function(t,r,i,s,o,a){var f=n.pop(),l=n.pop(),c=e.pop().copyFrom(r).sub(t),h=c.dot(o);u(i,o,f),u(s,o,l),l[0]+=h,l[1]+=h;var p=!1,d=!1;if(f[0]>l[1]||l[0]>f[1])return e.push(c),n.push(f),n.push(l),!0;if(a){var v=0;f[0]<l[0]?(a.aInB=!1,f[1]<l[1]?(v=f[1]-l[0],a.bInA=!1):(p=f[1]-l[0],d=l[1]-f[0],v=p<d?p:-d)):(a.bInA=!1,f[1]>l[1]?(v=f[0]-l[1],a.aInB=!1):(p=f[1]-l[0],d=l[1]-f[0],v=p<d?p:-d));var m=Math.abs(v);m<a.overlap&&(a.overlap=m,a.overlapN.copyFrom(o),v<0&&a.overlapN.reverse())}return e.push(c),n.push(f),n.push(l),!1},f=function(e,t){var n=e.len2(),o=t.dot(e);return o<0?r:o>n?s:i};this.testPolygonPolygon=function(e,t,n){var r=e.points,i=r.length,s=t.points,o=s.length;for(var u=0;u<i;u++)if(a(e.position,t.position,r,s,e.normals[u],n))return!1;for(u=0;u<o;u++)if(a(e.position,t.position,r,s,t.normals[u],n))return!1;return n&&(n.a=e,n.b=t,n.overlapV.copyFrom(n.overlapN).scale(n.overlap)),!0},o()}}),define("game/collision/response",["app/core","game/math/vector2"],function(e,t){return function(){this.a=null,this.b=null,this.overlapN=new t,this.overlapV=new t,this.overlap=Number.MAX_VALUE,this.aInB=!0,this.bInA=!0,this.clear=function(){return this.aInB=!0,this.bInA=!0,this.overlap=Number.MAX_VALUE,this}}}),define("game/collision/cell",[],function(){return function(){this.objects=[],this.add=function(e){this.objects.push(e)},this.remove=function(e){var t=this.objects.indexOf(e);this.objects.splice(t,1)},this.clear=function(){this.objects=[]},this.size=function(){return this.objects.length},this.get=function(e){return this.objects[e]}}}),define("game/collision/spatial-hash-grid",["game/math/vector2","game/collision/cell"],function(e,t){return function(e,n,r){this.width=e,this.height=n,this.cellsize=r,this.cellsPerRow=Math.ceil(e/this.cellsize),this.cellsPerCol=Math.ceil(n/this.cellsize),this.numCells=this.cellsPerRow*this.cellsPerCol,this.dynamic=new Array(this.numCells),this.static=new Array(this.numCells),this._CELL_IDS=new Array(4),this._FOUND_OBJECTS=[];for(var i=0;i<this.numCells;i++)this.dynamic[i]=new t,this.static[i]=new t;this.reset=function(){for(var e=0;e<this.numCells;e++)this.dynamic[e].clear(),this.static[e].clear()},this.registerDynamicActor=function(e){this.getCellIds(e);var t=0,n=-1;while(t<=3&&(n=this._CELL_IDS[t++])!==-1)this.dynamic[n].add(e)},this.registerStaticActor=function(e){this.getCellIds(e);var t=0,n=-1;while(t<=3&&(n=this._CELL_IDS[t++])!==-1)this.static[n].add(e)},this.unregistActor=function(e){this.getCellIds(e);var t=0,n=-1;while(t<=3&&(n=this._CELL_IDS[t++])!==-1)this.dynamic[n].remove(e),this.static[n].remove(e)},this.getCellIds=function(e){this._CELL_IDS=new Array(4);var t=e.bounds.getBottomLeft(),n=e.bounds.getTopRight(),i=~~(t.x/r),s=~~(t.y/r),o=~~(n.x/r),u=~~(n.y/r),a=0;if(i===o&&s===u)i>=0&&i<this.cellsPerRow&&s>=0&&s<this.cellsPerCol?this._CELL_IDS[0]=i+s*this.cellsPerRow:this._CELL_IDS[0]=-1,this._CELL_IDS[1]=-1,this._CELL_IDS[2]=-1,this._CELL_IDS[3]=-1;else if(i===o){a=0,i>=0&&i<this.cellsPerRow&&(s>=0&&s<this.cellsPerCol&&(this._CELL_IDS[a++]=i+s+this.cellsPerRow),u>=0&&u<this.cellsPerCol&&(this._CELL_IDS[a++]=i+u+this.cellsPerRow));while(a<3)this._CELL_IDS[a++]=-1}else if(s===u){a=0,s>=0&&i<this.cellsPerCol&&(i>=0&&i<this.cellsPerRow&&(this._CELL_IDS[a++]=i+s+this.cellsPerRow),o>=0&&o<this.cellsPerRow&&(this._CELL_IDS[a++]=o+s+this.cellsPerRow));while(a<3)this._CELL_IDS[a++]=-1}else{a=0;var f=s*this.cellsPerRow,l=u*this.cellsPerRow;i>=0&&i<this.cellsPerRow&&s>=0&&s<this.cellsPerCol&&(this._CELL_IDS[a++]=i+f),o>=0&&i<this.cellsPerRow&&s>=0&&s<this.cellsPerCol&&(this._CELL_IDS[a++]=o+f),o>=0&&i<this.cellsPerRow&&u>=0&&u<this.cellsPerCol&&(this._CELL_IDS[a++]=o+f),i>=0&&i<this.cellsPerRow&&u>=0&&u<this.cellsPerCol&&(this._CELL_IDS[a++]=i+f)}},this.getPotentialColliders=function(e){this._FOUND_OBJECTS=[],this.getCellIds(e);var t=0,n=-1,r=null;while(t<=3&&(n=this._CELL_IDS[t++])!==-1){var i=this.dynamic[n].size();for(var s=0;s<i;s++)r=this.dynamic[n].get(s),this._FOUND_OBJECTS.indexOf(r)===-1&&this._FOUND_OBJECTS.push(r);i=this.static[n].size();for(s=0;s<i;s++)r=this.static[n].get(s),this._FOUND_OBJECTS.indexOf(r)===-1&&this._FOUND_OBJECTS.push(r)}}}}),define("game/collision/collision-handler",["app/core","game/math/vector2","game/collision/sat","game/collision/response","game/collision/spatial-hash-grid"],function(e,t,n,r,i){return function(e,t,s){var o,u,a,f,l,c=function(){a=new n,l=new i(e,t,s,10),f=new r};this.check=function(e){o=e,l.reset();for(var t=0;t<o.length;t++)u=o[t],u.collidable===!0&&(u.static===!0?l.registerStaticActor(u):l.registerDynamicActor(u));for(t=0;t<o.length;t++)if(o[t].TYPE==="BALL")var n=l.getPotentialColliders(o[t])};var h=function(){for(var e=0;e<o.length;e++){var t=o[e];if(u===t)continue;if(t.TYPE==="TAIL")continue;p(u,t)}},p=function(e,t){var n=e.bounds,r=t.bounds,i={left:n.position.x-n.size.x/2,right:n.position.x+n.size.x/2,top:n.position.y-n.size.y/2,bottom:n.position.y+n.size.y/2},s={left:r.position.x-r.size.x/2,right:r.position.x+r.size.x/2,top:r.position.y-r.size.y/2,bottom:r.position.y+r.size.y/2};s.left>i.right||s.right<i.left||s.top>i.bottom||s.bottom<i.top||v(e,t)},d=function(e,t,n){return Math.min(Math.max(e,t),n)},v=function(e,t){f.clear();var n=!1;n=a.testPolygonPolygon(e.bounds.toPolygon(),t.bounds.toPolygon(),f);if(n){if(e.TYPE==="TAIL"||t.TYPE==="TAIL")return;t.noCollision||(e.position.sub(f.overlapV),e.velocity.reflect(f.overlapN.perp())),e.hasOwnProperty("collision")&&e.collision(t),t.hasOwnProperty("collision")&&t.collision(e)}};c()}}),define("game/input/input-handler",["app/core","game/math/vector2"],function(e,t){return function(e){this.inputs=e||{}}}),define("game/world",["app/core","game/math/vector2","game/item/ball","game/item/player","game/item/wall","game/collision/collision-handler","game/input/input-handler"],function(e,t,n,r,i,s,o){return function(){this.size=new t(300,200),this.cellSize=50,this.gravity=new t(0,0),this.roundOver=!0,this.round=1,this.items=[];var e=this,u,a,f,l;this.inputHandler=new o({player1Up:function(){a.up()},player1Down:function(){a.down()},player2Up:function(){f.up()},player2Down:function(){f.down()}}),this.initWorld=function(){l=new s(this.size.x,this.size.y,this.cellSize),this.items=[],u=new n(this.size.x/2,this.size.y/2,2),a=new r(5,this.size.y/2,3,40),f=new r(this.size.x-5,this.size.y/2,3,40),this.initBall();var e,t;for(var o=1;o<=this.size.x/this.cellSize;o++)e=this.cellSize-1,t=new i(o*this.cellSize-this.cellSize/2,2.5,e,5),this.items.push(t);for(o=1;o<=this.size.x/this.cellSize;o++)e=this.cellSize-1,t=new i(o*this.cellSize-this.cellSize/2,this.size.y-2.5,e,5),this.items.push(t);for(o=1;o<=this.size.y/this.cellSize;o++)e=this.cellSize-1,t=new i(-2.5,o*this.cellSize-this.cellSize/2,5,e),this.items.push(t);for(o=1;o<=this.size.y/this.cellSize;o++)e=this.cellSize-1,t=new i(this.size.x+2.5,o*this.cellSize-this.cellSize/2,5,e),this.items.push(t);this.items.push(u),this.items.push(a),this.items.push(f);var c=u},this.initBall=function(){u.position=new t(this.size.x/2,this.size.y/2),u.velocity=new t(5,0)},this.initPlayer=function(){a.speed=2,f.speed=2},this.initWorld(),this.update=function(e){var n=new t(this.gravity.x,this.gravity.y);n.mulScalar(e);for(var r=0;r<this.items.length;r++){var i=this.items[r];i.update(e),c(i,n)}l.check(this.items),this.roundOver&&p()};var c=function(e,t){e.affectedByGravity&&e.addForce(t)},h=function(t){if(t.TYPE="BALL")e.round++,e.roundOver=!0},p=function(){e.roundOver=!1,e.initBall(),e.initPlayer()}}}),define("game/render2D",["app/core"],function(e){return function(e){var t,n,r,i,s=0,o=0,u=!1,a=function(){t=e.getContext("2d"),f()};this.initCanvas=function(){i=!1},this.toggleBoundingBoxes=function(){u=!u},this.init=function(){a()},this.draw=function(e){n=e.world,r=e.camera,i||l(),f(),h();for(var t=0;t<n.items.length;t++)p(n.items[t])};var f=function(){t.clearRect(0,0,e.width,e.height),t.fillStyle="#000000",t.fillRect(0,0,e.width,e.height)},l=function(){if(r){var t=e.width/r.size.x,n=e.height/r.size.y;i=t<n?t:n,s=e.width/2-r.size.x*i/2,o=e.height/2-r.size.y*i/2}},c=function(e){return e*i},h=function(){var e=c(r.size.x,"x"),n=c(r.size.y,"y");t.fillStyle="#ffffff",t.fillRect(s,o,e,n)},p=function(n){if(!d(n))return;var r=c(n.position.x)+s,i=c(n.position.y)+o,a=c(n.size.x),f=c(n.size.y);u&&n.bounds&&m(n.bounds),t.translate(r,e.height-i),t.fillStyle=v(n.TYPE),n.TYPE==="BALL"||n.TYPE==="TAIL"?(t.beginPath(),t.arc(0,0,c(n.radius),0,Math.PI*2,!0),t.fill(),t.closePath()):t.fillRect(-a/2,-f/2,a,f),t.translate(r*-1,(e.height-i)*-1)},d=function(e){return e.position.x-e.size.x/2>r.size.x||e.position.x+e.size.x/2<0||e.position.y-e.size.y/2>r.size.x||e.position.y+e.size.y/2<0?!1:!0},v=function(e){var t;switch(e){case"BALL":t="#00ff00";break;case"PLAYER":t="#0000ff";break;case"WALL":t="#00ff00";break;case"TAIL":t="#00cc00";break;default:t="#000000"}return t},m=function(n){t.beginPath(),t.lineWidth=1,t.strokeStyle="#ff0000";var r=c(n.position.x)+s,i=c(n.position.y)+o;switch(n.TYPE){case"RECT":var u=c(n.size.x),a=c(n.size.y);t.rect(r-u/2,e.height-(i+a/2),u,a);break;case"CIRCLE":var f=c(n.radius/2);t.arc(r,e.height-i,f,0,Math.PI*2,!0)}t.stroke()};a()}}),define("game/camera",["app/core","game/math/vector2"],function(e,t){return function(e,n,r,i){this.size=new t(r,i),this.position=new t(e,n);var s=function(){};s()}}),define("game/input/keyboard-controller",["app/core"],function(e){return function(t,n){var r={};document.onkeydown=function(e){var i=(e||window.event).keyCode;return i in t?(i in r||(r[i]=null,t[i](),n!==0&&(r[i]=setInterval(t[i],n))),!1):!0},document.onkeyup=function(e){var t=(e||window.event).keyCode;t in r&&(r[t]!==null&&clearInterval(r[t]),delete r[t])},window.onblur=function(){for(var e in r)r[e]!==null&&clearInterval(r[e]);r={}}}}),define("game/snakepong",["app/core","game/loop","game/debug","game/world","game/render2D","game/camera","game/input/keyboard-controller"],function(e,t,n,r,i,s,o){return function(u){var a,f,l,c,h,p,d,v=e.dom.el("#debug"),m=e.dom.el(".fps",v),g=function(){h=new i(u),y(),a=new t({updateCallback:b,renderCallback:w,fpsCallback:E}),S(),a.start()},y=function(){f=new r,p=new s(150,100,300,200);var e=new o({87:function(){f.inputHandler.inputs.player1Up()},83:function(){f.inputHandler.inputs.player1Down()},38:function(){f.inputHandler.inputs.player2Up()},40:function(){f.inputHandler.inputs.player2Down()}},100)},b=function(e){f.update(e)},w=function(){h.draw({camera:p,world:f})};this.canvasChange=function(e,t){h.initCanvas()};var E=function(e){m.innerHTML=e.toFixed(2),d.addFps(e)},S=function(){var t=e.dom.el("nav .start",v);t.onclick=function(){a.start()};var r=e.dom.el("nav .pause",v);r.onclick=function(){a.pause()};var i=e.dom.el("nav .resume",v);i.onclick=function(){a.resume()};var s=e.dom.el("nav .stop",v);s.onclick=function(){a.stop(),y(),d.reset()};var o=e.dom.el("nav .boundingToggle",v);o.onclick=function(){h.toggleBoundingBoxes()},d=new n(e.dom.el("#debugFps",v))};g()}}),require.config({baseUrl:"src"}),require(["app/core","gui/canvas-handler","game/snakepong"],function(e,t,n){var r=e.dom.el(".game"),i=e.dom.el("#main-canvas"),s,o=e.dom.el("#debug"),u,a=function(){f(),s=new n(i),u=new t(i),u.registerListener(s)},f=function(){var t=e.dom.el(".toggleFullscreen",r);e.event.add(t,"click",l),e.event.add(document,"keydown",function(t){var n=(t||window.evt).keyCode;n===68?e.classlist.toggle(o,"show"):n===70&&(e.classlist.toggle(r,"fullscreen"),u.update())})},l=function(){u.update(),e.classlist.toggle(r,"fullscreen")};a()}),define("main",function(){});